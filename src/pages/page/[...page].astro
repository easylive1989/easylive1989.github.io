---
import BaseLayout from '../../layouts/BaseLayout.astro';
import Header from '../../components/Header.astro';
import Footer from '../../components/Footer.astro';
import Sidebar from '../../components/Sidebar.astro';
import ArticleCard from '../../components/ArticleCard.astro';
import articlesData from '../../../public/articles.json';
import type { Page } from 'astro';
import type { Article } from '../../types';

export async function getStaticPaths({ paginate }: any) {
    const data = articlesData as any;

    return paginate(data.articles, {
        pageSize: 10
    });
}

interface Props {
    page: Page<Article>;
}

const { page } = Astro.props;
---

<BaseLayout>
    <Header />

    <main>
        <div class="container">
            <div class="main-content">
                <!-- Left: Articles List -->
                <div class="articles-section">
                    {page.data.map(article => (
                        <ArticleCard article={article} />
                    ))}

                    <!-- Pagination -->
                    {page.lastPage > 1 && (
                        <div class="pagination">
                            <a
                                href={page.url.prev || '#'}
                                class:list={['pagination-button', { disabled: !page.url.prev }]}
                                aria-disabled={!page.url.prev}
                            >
                                ← 上一頁
                            </a>
                            <span class="pagination-info">第 {page.currentPage} 頁 / 共 {page.lastPage} 頁</span>
                            <a
                                href={page.url.next || '#'}
                                class:list={['pagination-button', { disabled: !page.url.next }]}
                                aria-disabled={!page.url.next}
                            >
                                下一頁 →
                            </a>
                        </div>
                    )}
                </div>

                <!-- Right: Sidebar -->
                <Sidebar />
            </div>
        </div>
    </main>

    <Footer />
</BaseLayout>
